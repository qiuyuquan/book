# http相关知识

## http/1.x的缺陷
* **连接无法复用**：连接无法复用会导致每次请求会经历三次握手和慢启动，而三次握手在搞延迟的场景下影响较大
 1. http/1.0传输数据时，每次都要重新建立连接，增加延迟
 2. http/1.1 虽然加入了keep-alive可以复用一部分连接，但域名分片的情况下任需建立多个连接，耗费资源

* **对头阻塞**：同一个域名下同时发起http请求不能超过6个，超过则需要等待其他资源完成后，才能发起请求。
  1. http/1.0传输数据时，下个请求必须在前一个请求返回后才能发出
  2. http/1.1可以一次发出多个请求，但是要求返回是按序的，如果前一个请求如果很耗时的话，那么即使后面的请求已处理完成，也回等到前面的处理完成才开始返回。

* **协议开销大**：在http1.x中，header携带的内容过大，在一定程度上增加了传输成本，并且每次请求header基本不怎么变化。

* **安全因素**：http1.x传输数据时，传输的内容都是明文，客户端和服务端都无法验证对方身份。

## SPDY协议
因为http1.x的问题，谷歌推出SPDY，降低延迟，压缩header等，为http/2带来前景。

## http/2简介
新特性
* **1. 二进制传输**
http/1.x采用的文本传输，而http/2采用二进制格式传输数据，解析起来更搞笑。
http/2将请求和响应数据分割为更小的帧，并且他们采用二进制编码

* **2. 多路复用**
多路复用解决了浏览器限制统一域名下的请求数量的问题。同一个域名只需要占用一个tcp连接，使用一个连接可以并行发送多个请求和响应，解决多个tcp连接带来的延时和内存消耗。

* **3. header压缩**
在http/1中，我们使用文本传输header，在header传输cookie的情况下，可能每次需要重复传输几百到几千的字节。因此http/2对这些首部采取了压缩策略。

在客户端和服务端建立首部表来跟踪和对应每次发送的键值对，对应相同的数据，不在通过每次请求和响应发送。（就是双方建立起一个对应表，发送和响应时，判断是否对应表中是否有对应的字段，有的话就不发送了）

[一文读懂 HTTP/2 及 HTTP/3 特性](https://blog.fundebug.com/2019/03/07/understand-http2-and-http3/)